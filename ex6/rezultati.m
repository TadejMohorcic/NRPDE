% LINEARNA FUNKCIJA IN INTEGRIRANJE

T = [0 0; 1 0; 0 1];
t = [0; 2; -1];
[X,Y] = meshgrid(0:0.25:1,0:0.25:1);

[f, fdx, fdy] = trilin(T,t);
f(X,Y)

%         0    0.5000    1.0000    1.5000    2.0000
%   -0.2500    0.2500    0.7500    1.2500    1.7500
%   -0.5000         0    0.5000    1.0000    1.5000
%   -0.7500   -0.2500    0.2500    0.7500    1.2500
%   -1.0000   -0.5000         0    0.5000    1.0000


triintegral(@(x,y)f(x,y),T);
% 0.166666666666694

% ploscina trikotnika
f = @(x,y) x.*0 + 1;
triintegral(@(x,y)f(x,y),T)
% 0.500000000000000

f = @(x,y)cos(x.^2).*sin(3*y);
triintegral(f,T)
% 0.311452135991796


% METODA KONCNIH ELEMENTOV

% Naloga_5a
% Vrednost resitve v notranjih tockah triangulacije (na robu je vedno 0):

% (0.250000,0.500000): 0.059523809523808
% (0.750000,0.500000): 0.059523809523810


% Naloga_5b
% Vrednosti v tockah mreze (i/10, j/10), i, j = 0, 1, 2, ..., 10, pri metodi koncnih elementov:

%  Columns 1 through 6
%{
                   0   0.001000000000000   0.008000000000000   0.027000000000000   0.064000000000000   0.125000000000000
   0.587785252292473   0.340257000023644   0.213769458037083   0.158313754829703   0.147904221615012   0.169575205195251
   0.951056516295154   0.548473289765022   0.338507077294985   0.234581339666718   0.189727926435094   0.177880681225752
   0.951056516295154   0.554072565446306   0.347204221711119   0.241776600107089   0.188545463232895   0.158417274680116
   0.587785252292473   0.359556234013928   0.244460643996098   0.186775375817622   0.154260051709284   0.125613233614454
   0.000000000000000   0.041906474320834   0.074306744441720   0.096604207458017   0.106106134172162   0.096923206296971
  -0.587785252292473  -0.276237081172311  -0.095744348008067   0.009228575400566   0.066637071224375   0.087562845243153
  -0.951056516295154  -0.473325198709539  -0.200275630702242  -0.040582629072060   0.053650730081619   0.105356819471330
  -0.951056516295154  -0.475731566668452  -0.201450347019301  -0.034934191068183   0.073191658702831   0.147837692628184
  -0.587785252292473  -0.287094204649813  -0.104859999638329   0.019104553115798   0.116212403169705   0.202553400860192
                   0   0.010000000000000   0.040000000000000   0.090000000000000   0.160000000000000   0.250000000000000

  Columns 7 through 11

   0.216000000000000   0.343000000000000   0.512000000000000   0.729000000000000   1.000000000000000
   0.217515917940241   0.290686147973168   0.394045719395599   0.546700265492966   0.809016994374947
   0.183802318592545   0.198182954556829   0.216796464116263   0.244738348201317   0.309016994374947
   0.131629720647361   0.091446887545339   0.020218834311309  -0.103560331178909  -0.309016994374947
   0.082852401771446   0.005756040665857  -0.133807683237458  -0.380181512853316  -0.809016994374947
   0.058410612158112  -0.027467443415901  -0.191024095073681  -0.484341042621948  -1.000000000000000
   0.071334283979935   0.006987668586109  -0.128480211019418  -0.376158562560798  -0.809016994374947
   0.122376009932367   0.102564044799819   0.036274144970699  -0.092796002226876  -0.309016994374948
   0.200248891478382   0.234618355710102   0.253808748329274   0.267717403057539   0.309016994374947
   0.286163507642877   0.371851738232933   0.466625089578754   0.590839871752811   0.809016994374947
   0.360000000000000   0.490000000000000   0.640000000000000   0.810000000000000   1.000000000000000
%}

% Maksimalna absolutna razlika med metodo koncnih elementov in diferencno metodo v tockah mreze: 1.387778780781446e-15
% Pomemben je red napake (1e-15).

% Naloga_5c
% Maksimalna napaka v tockah triangulacije: 0.042738326434892

%{
Vrednosti v nekaterih notranjih tockah triangulacije:

indeks 247 (0.680864, 0.634962) 0.319597
indeks 257 (0.097544, 0.480110) 0.104460
indeks 267 (0.874679, 0.635609) -0.530880
indeks 277 (0.055869, 0.532291) -0.189166
indeks 287 (0.547446, 0.160844) -0.810335
indeks 297 (0.147317, 0.164342) 0.517745
indeks 307 (0.873876, 0.767085) -0.698056
indeks 317 (0.737103, 0.560544) 0.043966
indeks 327 (0.201421, 0.177894) 0.273916
indeks 337 (0.307243, 0.187996) -0.321467
indeks 347 (0.867245, 0.575547) -0.307377
indeks 357 (0.157693, 0.184834) 0.505130
indeks 367 (0.471302, 0.632716) 0.730023
indeks 377 (0.220405, 0.444632) 0.087920
indeks 387 (0.607876, 0.609174) 0.498918
indeks 397 (0.190683, 0.545237) -0.088892
indeks 407 (0.892175, 0.659845) -0.655720
indeks 417 (0.359367, 0.498006) 0.006376
indeks 427 (0.121894, 0.404846) 0.413954
indeks 437 (0.318008, 0.346842) -0.297302
indeks 447 (0.252716, 0.226643) -0.005495
indeks 457 (0.131093, 0.465166) 0.152733
indeks 467 (0.436256, 0.335405) -0.751775
%}
